CREATE DATABASE DB_LOJA
GO

-- EXERCICIO 1
CREATE TABLE TB_DEPARTAMENTOS(
    DEP_CODIGO INTEGER NOT NULL IDENTITY,
    DEP_DESCONTO DECIMAL(3,2),
    DEP_NOME VARCHAR(20)
    CONSTRAINT PK_DEPARTAMENTOS PRIMARY KEY(DEP_CODIGO)
)
GO

INSERT INTO TB_DEPARTAMENTOS(DEP_DESCONTO, DEP_NOME) VALUES
    (0.1, 'CALÇADOS'), (0.2,'NATAÇÃO'),
    (0.3, 'VESTUÁRIO'), (0.4, 'FUTEBOL'),
    (0.5, 'TENNIS'), (0.6, 'VOLEI')
GO

SELECT D.DEP_NOME AS 'DEPARTAMENTO', D.DEP_DESCONTO AS 'DESCONTO' FROM TB_DEPARTAMENTOS D
GO

--EXERCICIO 2

CREATE TABLE TB_MARCAS(
    MAR_CODIGO INTEGER NOT NULL IDENTITY,
    MAR_MARCA VARCHAR(20),
    CONSTRAINT PK_MARCAS PRIMARY KEY(MAR_CODIGO)
)
GO
INSERT INTO TB_MARCAS(MAR_MARCA)
VALUES ('NIKE'),('ADIDAS'),('PUMA'),('MIZUNO'),('OAKLEY'),('ASICS'),('TOPPER'),('UMBRO')
GO
SELECT* FROM TB_MARCAS
GO

CREATE TABLE TB_PRODUTOS(
    PRO_CODIGO INTEGER IDENTITY,
    PRO_DEP_CODIGO INTEGER,
    PRO_MAR_CODIGO INTEGER,
    PRO_NOME VARCHAR(20),
    PRO_QT_ESTOQUE INTEGER,
    PRO_QT_MINIMA INTEGER,
    PRO_DES_PRODUTO VARCHAR(100),
    PRO_PRECO DECIMAL(10,2),
    CONSTRAINT PK_PRODUTOS PRIMARY KEY(PRO_CODIGO),
    CONSTRAINT FK_DEP_PRO FOREIGN KEY (PRO_DEP_CODIGO)
        REFERENCES TB_DEPARTAMENTOS(DEP_CODIGO),
    CONSTRAINT FK_MAR_PRO FOREIGN KEY(PRO_MAR_CODIGO)
        REFERENCES TB_MARCAS(MAR_CODIGO)
)
GO

INSERT INTO TB_PRODUTOS
    (PRO_DEP_CODIGO, PRO_MAR_CODIGO,
    PRO_NOME, PRO_QT_ESTOQUE,PRO_QT_MINIMA,
    PRO_DES_PRODUTO, PRO_PRECO)
VALUES
    (1, 1, 'TENIS', 10, 5, 'TENIS NIKE', 100.00),
    (1, 2, 'CHUTEIRA', 10, 5, 'TENIS ADIDAS', 100.00),
    (1, 3, 'TENIS', 10, 5, 'TENIS PUMA', 100.00),
    (4, 1, 'BOLA', 10, 5, 'BOLA NIKE', 100.00),
    (4, 5, 'CAMISA', 10, 5, 'CAMISA OAKLEY', 100.00),
    (5, 6, 'RAQUETE', 10, 5, 'RAQUETE ASICS', 100.00),
    (5, 7, 'BOLA', 10, 5, 'BOLA TOPPER', 100.00),
    (2, 8, 'TOCA', 10, 5, 'TOCA UMBRO', 100.00)
GO

SELECT* FROM TB_PRODUTOS P
GO

SELECT 
    P.PRO_DES_PRODUTO AS 'DESCRIÇÃO DO PRODUTO',
    P.PRO_PRECO AS 'VALOR DE VENDA',
    P.PRO_QT_ESTOQUE AS 'QUANTIDADE EM ESTOQUE'
FROM TB_PRODUTOS P
GO

--QUESTÃO 3
INSERT INTO TB_PRODUTOS
    (PRO_DEP_CODIGO, PRO_MAR_CODIGO,
    PRO_NOME, PRO_QT_ESTOQUE,PRO_QT_MINIMA,
    PRO_DES_PRODUTO, PRO_PRECO)
VALUES
    (1, 1, 'CHUTEIRA', 5, 15, 'CHUTEIRA NIKE',150.00)
GO


SELECT 
    P.PRO_DES_PRODUTO AS 'DESCRIÇÃO DO PRODUTO',
    P.PRO_PRECO AS 'VALOR DE VENDA',
    P.PRO_QT_ESTOQUE AS 'QUANTIDADE EM ESTOQUE',
    P.PRO_QT_MINIMA
FROM TB_PRODUTOS P
WHERE P.PRO_QT_ESTOQUE < P.PRO_QT_MINIMA
GO

--QUESTÃO 5
CREATE TABLE TB_ESTADOS(
    EST_CODIGO INTEGER IDENTITY,
    EST_NOME VARCHAR(50),
)
GO

INSERT INTO TB_ESTADOS(EST_NOME)
VALUES('ALAGOAS'),('BAHIA'),('CEARÁ'),('MARANHÃO'),('PARAIBA'),('PERNAMBUCO'),('PIAUÍ'),('RIO GRANDE DO NORTE'),('SERGIPE')
GO

CREATE TABLE TB_CIDADES(
    CID_CODIGO INTEGER IDENTITY,
    CID_NOME VARCHAR(50),
    CID_EST_CODIGO INTEGER,
    CONSTRAINT PK_CIDADES PRIMARY KEY(CID_CODIGO)
)
GO

INSERT INTO TB_CIDADES (CID_NOME, CID_EST_CODIGO)
VALUES
    ('MACEIÓ',1), ('ARAPIRACA',1), ('FEIRA DE SANTANTA', 2),
    ('SALVADOR', 2), ('FORTALEZA', 3), ('SÃO LUIZ',4), ('JOÃO PESSOA',5),
    ('RECIFE', 6), ('TERESINA', 7), ('NATAL', 8), ('MOSSORÓ', 8), ('ARACAJU', 9)
GO

SELECT* FROM TB_CIDADES

CREATE TABLE TB_BAIRROS(
    BAI_CODIGO INTEGER IDENTITY,
    BAI_NOME VARCHAR(50),
    BAI_CID_CODIGO INTEGER,
    CONSTRAINT PK_BAIRROS PRIMARY KEY(BAI_CODIGO)
)
GO

INSERT INTO TB_BAIRROS(BAI_NOME, BAI_CID_CODIGO)
VALUES
    ('PONTA VERDE', 1),
    ('JATIÚCA',1),
    ('CENTRO', 2),
    ('SIM', 3),
    ('BARRA DO CEARÁ', 4),
    ('COHAB', 5),
    ('MANGABEIRA', 6),
    ('BOA VIAGEM', 7),
    ('SÃO CRISTÓVÃO', 8),
    ('CIDADE DA ESPERANÇA', 9),
    ('CIDADE ALTA', 9),
    ('NOSSA SENHORA DO SOCORRO', 11)
GO

CREATE TABLE TB_SEXO(
    SEX_CODIGO INTEGER IDENTITY,
    SEX_SEXO VARCHAR(11),
    CONSTRAINT PK_SEXO PRIMARY KEY(SEX_CODIGO)
)
GO

INSERT INTO TB_SEXO(SEX_SEXO) VALUES ('MASCULINI'), ('FEMININO')
GO

SELECT* FROM TB_SEXO
WHERE SEX_SEXO ='MASCULINI'
GO

UPDATE TB_SEXO SET SEX_SEXO = 'MASCULINO' WHERE SEX_SEXO ='MASCULINI'
GO


CREATE TABLE TB_VENDEDORES(
    VEN_CODIGO INTEGER IDENTITY,
    VEN_BAI_CODIGO INTEGER,
    VEN_SEX_CODIGO INTEGER,
    VEN_NOME VARCHAR(50),
    VEN_CPF VARCHAR(14),
    VEN_RG VARCHAR(20),
    VEN_DT_ADMISSAO DATE,
    VEN_LOGRADOURO VARCHAR(50),
    VEN_NUMERO VARCHAR(10)
)
GO
INSERT INTO TB_VENDEDORES
    (VEN_BAI_CODIGO, 
    VEN_SEX_CODIGO, VEN_NOME, 
    VEN_CPF, VEN_RG, VEN_DT_ADMISSAO, 
    VEN_LOGRADOURO,VEN_NUMERO)
VALUES
    (1, 1, 'JOÃO', '12345678901', '123456789', '2019-01-01', 'RUA A', '1'),
    (2, 1, 'MARIA', '12345678902', '123456788', '2019-01-01', 'RUA B', '2'),
    (3, 2, 'JOSÉ', '12345678903', '123456787', '2019-01-01', 'RUA C', '3'),
    (4, 2 , 'JOSÉ', '1234567894', '123456786', '2019-01-01', 'RUA D', '4'),
    (5, 2, 'JULIA', '12345678905', '123456785', '2019-01-01', 'RUA E', '5')
GO

SELECT
    V.VEN_CODIGO AS 'MATRICULA',
     V.VEN_NOME AS 'NOME',
      V.VEN_DT_ADMISSAO AS 'ADMISSAO'
 FROM TB_VENDEDORES V
WHERE V.VEN_DT_ADMISSAO BETWEEN '2021-01-01' AND '2021-12-31' AND 
V.VEN_SEX_CODIGO= (SELECT S.SEX_CODIGO FROM TB_SEXO S WHERE S.SEX_SEXO = 'MASCULINO')
GO

SELECT* FROM TB_VENDEDORES
GO

UPDATE TB_VENDEDORES SET VEN_SEX_CODIGO =1 WHERE VEN_CODIGO =4
GO

-- QUESTÃO 7

CREATE TABLE TB_CLIENTES(
    CLI_CODIGO INTEGER IDENTITY,
    CLI_BAI_CODIGO INTEGER,
    CLI_NOME VARCHAR(50),
    CLI_LOGRADOURO VARCHAR(50),
    CLI_NUMERO VARCHAR(10),
    CONSTRAINT PK_CLIENTES PRIMARY KEY(CLI_CODIGO)
)
GO

INSERT INTO TB_CLIENTES(CLI_BAI_CODIGO, CLI_NOME, CLI_LOGRADOURO, CLI_NUMERO)
VALUES 
    (1, 'JOSE SILVA', 'RUA DAS PISTAS', '14'),
    (2, 'CARLOS SANTOS', 'AVENIDA AUGUSTA', 'SN'),
    (5, 'PEDRO GOMES', 'RUA DAS FLORES', '154'),
    (1, 'JOÃO SANTOS', 'RUA DAS ACACIAS', '63'),
    (1, 'MARIA TARGINO', 'TV MANGABEIRA', '89')
GO

SELECT C.CLI_NOME FROM TB_CLIENTES C
WHERE CLI_NOME LIKE '%SANTOS%'
GO


-- QUESTÃO 8
SELECT TOP 2
    P.PRO_DES_PRODUTO AS 'DESCRIÇÃO DO PRODUTO', 
    P.PRO_PRECO AS 'PREÇO' 
FROM TB_PRODUTOS P
ORDER BY P.PRO_PRECO ASC
GO

--QUESTÃO 9
SELECT TOP 2
    P.PRO_DES_PRODUTO AS 'DESCRIÇÃO DO PRODUTO', 
    P.PRO_PRECO AS 'PREÇO' 
FROM TB_PRODUTOS P
ORDER BY P.PRO_PRECO DESC
GO

--QUESTÃO 10

SELECT TOP 3
    V.VEN_CODIGO AS 'MATRICULA',
    V.VEN_DT_ADMISSAO AS 'DATA DE ADMISSÃO'
FROM TB_VENDEDORES V
ORDER BY V.VEN_DT_ADMISSAO ASC
GO



